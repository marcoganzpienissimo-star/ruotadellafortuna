<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ruota della Fortuna</title>

<style>
    body {
        font-family: Arial, sans-serif;
        text-align: center;
        margin: 0;
        padding: 20px;
        background: #fafafa;
    }

    h1 {
        font-size: 1.6rem;
    }

    /* --- MOBILE FIRST --- */
    .wheel-container {
        width: 90vw;
        max-width: 400px;
        height: 90vw;
        max-height: 400px;
        margin: 30px auto;
        position: relative;
    }

    /* PUNTATORE */
    .pointer {
        position: absolute;
        top: -25px;
        left: 50%;
        transform: translateX(-50%);
        width: 0;
        height: 0;
        border-left: 20px solid transparent;
        border-right: 20px solid transparent;
        border-bottom: 30px solid #222;
        z-index: 5;
    }

    /* RUOTA */
    .wheel {
        width: 100%;
        height: 100%;
        border-radius: 50%;
        border: 5px solid #000;
        transition: transform 5s cubic-bezier(.17,.67,.14,1);
    }

    /* BOTTONE */
    .spin-btn {
        padding: 14px 28px;
        font-size: 20px;
        background: #ff5722;
        color: #fff;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        margin-top: 10px;
        width: 80%;
        max-width: 300px;
    }

    .spin-btn:disabled {
        opacity: 0.5;
        cursor: default;
    }

    /* RISULTATO */
    #result {
        margin-top: 25px;
        font-size: 1.2rem;
        font-weight: bold;
    }

    a.riscatta {
        display: inline-block;
        margin-top: 15px;
        padding: 14px 24px;
        background: #2196f3;
        color: #fff;
        text-decoration: none;
        border-radius: 8px;
        font-size: 1.1rem;
    }
</style>
</head>

<body>

<h1>Ruota della Fortuna</h1>

<div class="wheel-container">
    <div class="pointer"></div>
    <canvas id="wheelCanvas" width="500" height="500"></canvas>
</div>

<button class="spin-btn" id="spinButton">Gira la Ruota</button>

<div id="result"></div>

<script>
/* ========= CONFIGURAZIONE SPICCHI ========= */
/* Puoi cambiare colori, testi, aggiungere immagini */

const prizes = [
    { label: "10% Sconto", color: "#f44336", url: "https://tuolink.com/10" },
    { label: "Dolce Omaggio", color: "#ff9800", url: "https://tuolink.com/dolce" },
    { label: "Bibita Gratis", color: "#ffeb3b", url: "https://tuolink.com/bibita" },
    { label: "Nessuna Vincita", color: "#4caf50", url: "https://tuolink.com/ritenta" },
    { label: "Antipasto", color: "#2196f3", url: "https://tuolink.com/antipasto" },
    { label: "CaffÃ¨ Gratis", color: "#9c27b0", url: "https://tuolink.com/caffe" }
];

/* ========= DISEGNO RUOTA ========= */

const canvas = document.getElementById("wheelCanvas");
const ctx = canvas.getContext("2d");
const size = canvas.width;
const radius = size / 2;

function drawWheel() {
    const arc = 2 * Math.PI / prizes.length;

    ctx.clearRect(0, 0, size, size);

    prizes.forEach((prize, index) => {
        const startAngle = index * arc;
        const endAngle = startAngle + arc;

        ctx.beginPath();
        ctx.moveTo(radius, radius);
        ctx.arc(radius, radius, radius, startAngle, endAngle);
        ctx.fillStyle = prize.color;
        ctx.fill();
        ctx.stroke();

        // Testo spicchio
        ctx.save();
        ctx.translate(radius, radius);
        ctx.rotate(startAngle + arc / 2);
        ctx.textAlign = "right";
        ctx.fillStyle = "#fff";
        ctx.font = "bold 22px Arial";
        ctx.fillText(prize.label, radius - 10, 10);
        ctx.restore();
    });
}

drawWheel();

/* ========= LOGICA DI ROTAZIONE ========= */

let rotation = 0;
let spinning = false;

document.getElementById("spinButton").addEventListener("click", () => {
    if (spinning) return;
    spinning = true;

    const extra = Math.floor(Math.random() * 360);
    const totalRotation = 360 * 8 + extra;

    rotation += totalRotation;

    canvas.style.transition = "transform 5s cubic-bezier(.17,.67,.14,1)";
    canvas.style.transform = `rotate(${rotation}deg)`;

    setTimeout(() => {
        const finalDeg = rotation % 360;
        const arc = 360 / prizes.length;
        const index = Math.floor((360 - finalDeg) / arc) % prizes.length;

        const prize = prizes[index];

        document.getElementById("result").innerHTML = `
            Hai vinto: <strong>${prize.label}</strong> ðŸŽ‰<br>
            <a class="riscatta" href="${prize.url}" target="_blank">Riscatta ora</a>
        `;

        spinning = false;
    }, 5000);
});
</script>

</body>
</html>
